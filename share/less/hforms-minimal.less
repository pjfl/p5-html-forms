/* Colours */
@alert-bg: lightpink;
@button-bg: bisque;
@button-bg-disabled: gainsboro;
@button-bg-lighter: whitesmoke;
@button-border: gainsboro;
@button-border-hover: limegreen;
@button-text: seagreen;
@button-text-hover: black;
@checkbox-bg-false: firebrick;
@checkbox-bg-true: seagreen;
@ds-tile-bg: bisque;
@field-bg-focus: bisque;
@field-bg-selected: bisque;
@field-text-required: firebrick;
@form-bg: ivory;
@form-bg-border: bisque;
@form-bg-border-focus: seagreen;
@form-bg-lighter: hsl(from @form-bg h s l / 0.25);
@line-border: gray;
@panel-shadow: gray;
@text: black;
@text-close: firebrick;
@text-disabled: gray;
/* Dimensions */
@alert-max-width: 14rem;
@display-text-max-width: 20rem;
@display-text-min-width: 15rem;
@checkbox-height: 1.25rem;
@checkbox-width: 40px;
@checkbox-width-knob: 20px;
@ds-form-max-width-horizontal: 21rem;
@error-max-width: 50rem;
@field-min-width: 15rem;
@field-row-gap: 0.75rem;
@filemanager-min-width: 10rem;
@form-min-width: 16rem;
@form-min-width-wide: 40rem;
@label-width: 7rem;
@label-width-narrow: 5rem;
@select-max-width: 12rem;
@select-option-min-width: 8rem;
@selector-min-width: 16rem;
@textarea-max-width: 24rem;
@textarea-min-width: 15rem;
/* Font Sizes and Weights */
@button-font-size: 0.7rem;
@button-font-weight: 415;
@data-font-size: 0.8rem;
@data-font-weight: normal;
@system-font-size: 0.8rem;
#fonts() {
    code: 'Cascadia Code', 'Menlo', 'DejaVu Sans Mono', ui-monospace, monospace;
    cursive: 'Segoe Print', 'Bradley Hand', 'Chilanka', casual, cursive;
    data: 'DejaVu Serif', 'Sitka Small', serif;
    mono: 'Nimbus Mono PS', 'Courier New', monospace;
    system: 'Roboto', system-ui, sans-serif;
}
#grads() {
    alert-bg-long: linear-gradient(to right, transparent, @alert-bg 80%);
    button-bg: linear-gradient(0deg, @button-bg, @button-bg-lighter);
    button-bg-border: radial-gradient(
        @button-border-hover, transparent, transparent
    );
    button-bg-disabled: linear-gradient(
        0deg, @button-bg-disabled, @button-bg-lighter
    );
}
form.classic {
    --label-width: @label-width; background: @form-bg-lighter;
    border-radius: 5px; box-shadow: 3px 3px 3px @panel-shadow; color: @text;
    display: inline-block; padding: 0 0.5rem 0.5rem; position: relative;
    .alert {
        font-family: #fonts[system]; font-size: @system-font-size;
    }
    .form-wrapper {
        border-radius: 5px; min-width: @form-min-width; margin: 0;
        padding: 0 1rem 0.25rem 1rem; position: relative;
        .form-title {
            color: @text; font-family: #fonts[system];
            margin-left: -2px;
        }
        &:has(.input-field span.field-label) .input-button button {
            margin-top: 1rem;
        }
    }
    &.narrow, .form-wrapper.narrow {
        --label-width: @label-width-narrow;
    }
    &.wide, .form-wrapper.wide {
        min-width: @form-min-width-wide;
    }
    .form-page > .alert-info, .form-wrapper > .alert-info, & > .alert-info {
        padding-bottom: 0.5rem;
    }
    .form-wrapper > .alert-info {
        padding-top: 0.25rem;
    }
    .input-field {
        padding-bottom: @field-row-gap; position: relative;
        &:has(label.field-label) {
            align-items: baseline; column-gap: 0.5rem; display: grid;
            grid-template-columns: var(--label-width) min-content auto;
            grid-template-areas: "label input selector" "label alert alert";
            justify-items: start; min-width: @field-min-width;
        }
        &.label-right:has(label.field-label) {
            grid-template-columns: min-content auto var(--label-width);
            grid-template-areas: "selector input label" "alert alert label";
            input, select, span, textarea {
                justify-self: end;
            }
        }
        &.collapse:not(.hide) {
            &:not(.input-datastructure):has(label.field-label) {
                grid-template-columns:
                    min-content min-content auto !important;
            }
        }
        &.hide {
            display: none !important; opacity: 0;
        }
        &.inline:not(.hide) {
            display: inline-grid !important; margin-right: 0.5rem;
            .input-field {
                padding-bottom: 0;
            }
        }
        &.shrink:not(.hide) {
            &:not(.input-datastructure):has(label.field-label) {
                grid-template-columns:
                    @label-width-narrow min-content auto !important;
            }
        }
        &:has(span.field-label) {
            display: grid;
            grid-template-columns: 0 min-content auto;
            grid-template-areas: "label input selector" "label alert alert";
            justify-content: center;
            input {
                height: 1.75rem; margin-top: 1.25rem; max-width: unset;
                outline: 0;
            }
            input[type=password], input[type=text]:not(.digit) {
                border-radius: 50px; padding-left: 0.75rem;
            }
            input.digit:first-child {
                border-bottom-left-radius: 50px; border-top-left-radius: 50px;
            }
            input.digit:last-child {
                border-bottom-right-radius: 50px; border-top-right-radius: 50px;
            }
        }
        span.field-label {
            border: 2px solid transparent; padding: 2px 0.25rem;
            position: absolute; top: 1.25rem; transition: top 0.5s;
            translate: 0.5rem;
        }
        &:hover span.field-label,
        &:has(input:focus) span.field-label,
        &:has(input:valid) span.field-label {
            top: -0.25rem;
        }
        &:has(.digit-input-wrapper) .field-label::after,
        &:has(input[required=required]) .field-label::after,
        &:has(select[required=required]) .field-label::after,
        &:has(textarea[required=required]) .field-label::after {
            color: @field-text-required; content: '*'; min-width: 2ch;
            padding-left: 0.25rem;
        }
        &:has(.digit-input-wrapper > input:valid) .field-label::after,
        &:has(input:valid) .field-label::after,
        &:has(select:valid) .field-label::after,
        &:has(textarea:valid) .field-label::after {
            content: 'â€ˆ';
        }
        input, select, textarea {
            border-radius: 5px; font-family: #fonts[data];
            font-size: @data-font-size; font-weight: @data-font-weight;
            grid-area: input;
        }
        input {
            height: 1.75rem;
        }
        select {
            background: #grads[button-bg]; max-width: @select-max-width;
            padding: 0.25rem;
            &.select-multiple option {
                padding: 0.125rem;
            }
        }
        textarea {
            box-sizing: content-box; min-height: 3lh;
            max-width: @textarea-max-width; min-width: @textarea-min-width;
            overflow: auto; padding: 0.25rem;
        }
        input:focus, textarea:focus {
            background: @field-bg-focus;
        }
        input[type=date], input[type=email], input[type=password],
        input[type=text] {
            padding: 0.125rem 0.25rem;
        }
        input[type=file] {
            height: unset;
            &::file-selector-button {
                background: #grads[button-bg];
                border: 2px outset @button-border; border-radius: 50px;
                color: @button-text; cursor: pointer;
                font-size: @button-font-size; font-weight: @button-font-weight;
                letter-spacing: 0.1rem; line-height: 0.8rem;
                padding: 0.366rem 0.75rem; text-transform: uppercase;
            }
            &::file-selector-button:hover {
                color: @button-text-hover;
            }
        }
        input[readonly=readonly] {
            color: @text-disabled;
        }
        input[readonly=readonly][type=datetime-local] {
            background: @form-bg-lighter; border: 0; color: @text;
        }
        input[type=submit], select:not(.select-multiple) option {
            font-family: #fonts[system]; font-size: @system-font-size;
        }
        select.select-multiple option {
            min-width: @select-option-min-width;
        }
        select.select-multiple option[selected=selected] {
            background: @field-bg-selected;
        }
        .alert {
            border-radius: 5px; display: block; font-size: @system-font-size;
            grid-area: alert; margin-top: 0.25rem; max-width: @alert-max-width;
            padding: 0.25rem 0.5rem;
        }
        .alert-error {
            background: @alert-bg;
            box-shadow: 3px 3px 3px @panel-shadow;
        }
        .alert-info {
            background: @field-bg-selected;
        }
        .field-label {
            font-family: #fonts[system]; font-size: @system-font-size;
            grid-area: label; position: relative; white-space: nowrap;
            .label-sep-after {
                position: absolute; right: 0.25rem;
            }
        }
        &.input-button, &.input-filter, &.input-hidden .alert {
            max-width: 100%;
        }
    }
    .data-structure, .input-button, .input-selector {
        isolation: isolate;
        button, a.form-button {
            background: #grads[button-bg];
            border: 2px outset @button-border; border-radius: 50px;
            color: @button-text; cursor: pointer; display: inline-block;
            overflow: hidden; position: relative; text-decoration: none;
            transition: border 0.5s, color 0.5s;
            span, svg {
                font-family: #fonts[system]; font-size: @button-font-size;
                font-weight: @button-font-weight; letter-spacing: 0.1rem;
                position: relative; text-decoration: none;
                text-transform: uppercase; white-space: nowrap; z-index: 3;
            }
            span.icon-wrapper {
                display: block;
                svg {
                    vertical-align: top;
                }
            }
        }
        button {
             padding: 0.25rem 0.75rem;
        }
        a.form-button {
             padding: 0.15rem 0.75rem;
        }
        button:hover, a.form-button:hover {
            border: 2px inset @button-border; color: @button-text-hover;
        }
        button::before, a.form-button::before {
            background: #grads[button-bg-border]; content: ''; display: block;
            height: 3rem; left: var(--x); opacity: 0; position: absolute;
            top: var(--y); transform: translate(-50%, -50%);
            transition: opacity 0.5s; width: 3rem; z-index: 1;
        }
        button:hover::before, a.form-button:hover::before {
            opacity: 1;
        }
        button::after, a.form-button::after {
            background: #grads[button-bg]; border-radius: 50px; content: '';
            inset: 3px; position: absolute; z-index: 2;
        }
        button[disabled=disabled], button[disabled=disabled]::after {
            background: #grads[button-bg-disabled];
        }
    }
    .input-boolean {
        .checkbox-wrapper {
            display: flex; grid-area: input; isolation: isolate;
            padding: 2px 0; position: relative;
            input[type=checkbox] {
                height: @checkbox-height; margin: 0; opacity: 0;
                position: relative; width: @checkbox-width; z-index: 3;
            }
        }
        .checkbox-wrapper::after {
            background: #grads[button-bg];
            border: 2px inset @button-border; border-radius: 10px;
            content: ''; display: block; position: absolute;
            height: @checkbox-height; left: 0;
            width: @checkbox-width-knob; z-index: 2;
        }
        .checkbox-wrapper:has(input[type=checkbox]:checked)::after {
            left: @checkbox-width-knob;
        }
        .checkbox-wrapper::before {
            background: @checkbox-bg-false;
            border: 2px inset @button-border; border-radius: 10px;
            content: ''; display: block; position: absolute;
            height: @checkbox-height; left: 0; width: @checkbox-width;
            z-index: 1;
        }
        .checkbox-wrapper:has(input[type=checkbox]:checked)::before {
            background: @checkbox-bg-true;
        }
        &:has(.label-checkbox) {
            align-items: center !important;
        }
    }
    .input-button {
        align-items: center; display: flex; justify-content: right;
        padding-top: 0.25rem;
        &.expand button {
            flex: 2;
        }
        &.right {
            margin-right: 0 !important; position: absolute; right: 0.5rem;
        }
    }
    .input-selector button {
        grid-area: selector;
    }
    .input-display {
        span {
            font-family: #fonts[data]; font-size: @data-font-size;
            grid-area: input; max-width: @display-text-max-width;
            padding: 3px 0.25rem 1px 0.35rem; white-space: nowrap;
        }
        span.breaking-text {
            min-width: @display-text-min-width; white-space: break-spaces;
        }
        span.code {
            min-width: @display-text-min-width; white-space: unset;
        }
        &:has(img) {
            align-items: flex-start !important;
        }
    }
    .input-duration .input-select-integer, .input-interval .input-group,
    .input-repeatable div, .input-time-with-zone .input-group {
        display: inline-block;
    }
    .input-captcha input, .input-integer input, .input-interval input,
    .input-money input, .input-number input {
        line-height: 1.75rem; padding-left: 0.25rem; text-align: right;
    }
    .input-duration .option-label .label-sep-after,
    .input-duration .option-label .label-sep-before,
    .input-hidden:not(.input-error) {
        display: none;
    }
    .input-hidden.input-error {
        display: block; width: 100%;
        .alert-error {
            max-width: 13rem;
        }
    }
    .input-immutable {
        h1, h2, h3, h4, h5 {
            margin: 0 0 0.5rem 0;
        }
        p, pre code {
            font-size: @system-font-size; line-height: 1rem; max-width: 50rem;
        }
        pre code {
            display: inline-block; white-space: break-spaces;
        }
    }
    .input-integer {
        .digit {
            border-left: none; border-radius: 0; border-right: none;
            outline: 0; text-align: center; width: 2rem;
        }
        .digit:first-child {
            border-left: 2px inset @button-border;
            border-bottom-left-radius: 5px; border-top-left-radius: 5px;
        }
        .digit:last-child {
            border-right: 2px inset @button-border;
            border-bottom-right-radius: 5px; border-top-right-radius: 5px;
        }
    }
    .input-password .reveal {
        cursor: pointer; grid-area: selector;
    }
    .input-select:has(label.select-multiple) {
        align-items: flex-start !important; padding-bottom: 0rem;
        label.select-multiple {
            padding-top: 0.33rem;
        }
    }
    .input-textarea:has(.field-label) {
        align-items: flex-start !important;
        .field-label {
            padding-top: 0.33rem;
        }
    }
    .digit-input-wrapper {
        display: flex; grid-area: input;
    }
    .ds-form {
        display: flex; flex-direction: column; padding-bottom: 1rem;
        position: relative; gap: 0.5rem;
        .ds-header {
            font-family: #fonts[system]; font-size: @system-font-size;
            font-weight: normal; padding-top: 0.2rem;
        }
        .ds-row {
            background: @ds-tile-bg;
            border-radius: 5px; box-shadow: 3px 3px 3px @panel-shadow;
            display: flex; justify-content: space-between; padding: 0.5rem;
        }
        .ds-field {
            border-radius: 5px; border-bottom-right-radius: 0;
            border-top-right-radius: 0; display: flex; flex-direction: column;
            img {
                aspect-ratio: 16 / 9; inline-size: 100%; object-fit: contain;
            }
            input[readonly=readonly] {
                background: @ds-tile-bg !important; font-family: #fonts[system];
                font-size: @system-font-size; font-weight: normal;
                &.input-datetime {
                    margin-left: -0.25rem;
                }
            }
            &.hide {
                display: none;
            }
        }
        .ds-field-group {
            display: flex;
            &.vertical {
                flex-direction: column;
            }
        }
        .ds-input.input-text[readonly=readonly] {
            background: @form-bg-lighter; border: 0; border-radius: 0;
            color: @text; padding: 0;
        }
        .ds-output {
            box-sizing: content-box; font-size: @system-font-size;
            margin-right: 0.25rem;
        }
        .ds-reorderable-drag {
            position: absolute;
        }
        .ds-reorderable {
            margin: auto; padding-left: 0.5rem;
            .knob {
                display: block; height: 20px; width: 20px;
            }
        }
        .ds-remove {
            border-radius: 5px; border-bottom-left-radius: 0;
            border-top-left-radius: 0; padding: 0.125rem 0 0 0.25rem;
            .ds-remove-icon {
                align-items: center; background: #grads[button-bg];
                border-radius: 3px;
                box-shadow: 2px 2px 2px @panel-shadow;
                color: @text-close; cursor: pointer; display: flex;
                font-family: #fonts[system]; font-size: @system-font-size;
                font-weight: bold; padding: 0 0.25rem;
                img, svg {
                    height: 20px; width: 20px; vertical-align: middle;
                }
                &:hover {
                    box-shadow: inset 0 0 3px @panel-shadow;
                    color: @text;
                }
            }
        }
        .ds-tag {
            padding-bottom: 0.25rem;
        }
        .ds-tag-label {
            font-family: #fonts[system]; font-size: @system-font-size;
            margin-right: 0.25rem;
        }
        &.horizontal {
            flex-direction: row; overflow-x: auto;
            max-width: @ds-form-max-width-horizontal;
            overscroll-behavior-inline: contain; padding-right: 0.25rem;
            scroll-behavior: smooth;
            &.snaps-inline {
                scroll-snap-type: inline mandatory;
            }
            &.snaps-inline > * {
                scroll-snap-align: start;
            }
        }
    }
    .form-page.hide {
        display: none;
    }
    .page-list {
        list-style-type: none; margin: 0; padding: 0 0 0.5rem 0;
        li {
            border-bottom: 1px solid @line-border;
            border-top-left-radius: 5px; border-top-right-radius: 5px;
            color: @text-disabled; cursor: pointer; display: inline;
            font-family: #fonts[system]; font-size: @system-font-size;
            padding: 0 0.5rem;
        }
        li.selected {
            border: 1px solid @line-border;
            border-bottom: 1px solid transparent; color: @text;
        }
    }
    &.shiny {
        @property --angle {
            syntax: '<angle>'; initial-value: 0deg; inherits: false;
        }
        @keyframes spin {
            from { --angle: 0deg; }
            to { --angle: 360deg; }
        }
        &::after {
            animation: 3s spin linear infinite;
            background: conic-gradient(
                from var(--angle), transparent 70%, @form-bg-border
            );
            border-radius: 5px; content: ''; height: 100%; left: 50%;
            position: absolute; top: 50%; translate: -50% -50%;
            width: 100%; z-index: -1;
        }
        &:focus-within::after {
            background: conic-gradient(
                from var(--angle), transparent 70%, @form-bg-border-focus
            );
        }
        .form-wrapper {
            background: @form-bg;
        }
    }
}
.form-error {
    background: @alert-bg; border: 1px solid @line-border;
    border-radius: 5px; box-shadow: 3px 3px 3px @panel-shadow;
    max-width: @error-max-width; overflow: hidden; padding: 0.5rem;
    h1, h2, h3 {
        margin: 0.5rem 0 !important;
    }
}
.form-messages {
    display: none;
    .alert {
        .card {
            font-family: #fonts[data]; font-weight: @data-font-weight;
            margin-top: 0.25rem; max-width: @error-max-width;
            padding: 0 0.25rem;
            p {
                margin: 0; max-height: 6rem; overflow: hidden;
                position: relative;
            }
            p.long::after {
                background-image: #grads[alert-bg-long];
                bottom: 0; content: ''; height: 1rem;
                position: absolute; right: 0; width: 100%;
            }
        }
    }
    .alert-error, .alert-error-message, .alert-severe .card {
        border-radius: 5px; background: @alert-bg;
        box-shadow: 3px 3px 3px @panel-shadow; padding: 0.25rem;
    }
    .alert-error, .alert-error-message {
        margin-left: -0.25rem;
    }
    &:has(span) {
        display: inline-flex; flex-direction: column; padding-bottom: 0.5rem;
    }
}
.modal .filemanager {
    margin: 0; min-width: @filemanager-min-width;
    .input-field:has(label.field-label) {
        grid-template-columns: auto max-content auto;
    }
}
.selector form.classic:not(.wide) {
    box-shadow: none; margin: 0; min-width: @selector-min-width;
    padding: 0;
}
